nesi_individuals_with_grants_2011 <- as.data.frame(lapply(nesi_individuals_with_grants_2011, function(x) gsub("<f3>", "\u00f3", x))) # o with acute
nesi_individuals_with_grants_2011 <- as.data.frame(lapply(nesi_individuals_with_grants_2011, function(x) gsub("\xfa", "\u00fa", x))) # u with acute
nesi_individuals_with_grants_2011 <- as.data.frame(lapply(nesi_individuals_with_grants_2011, function(x) gsub("<fa>", "\u00fa", x))) # u with acute
nesi_individuals_with_grants_2011 <- as.data.frame(lapply(nesi_individuals_with_grants_2011, function(x) gsub("\xda", "\u00da", x))) # U with acute
nesi_individuals_with_grants_2011 <- as.data.frame(lapply(nesi_individuals_with_grants_2011, function(x) gsub("<da>", "\u00da", x))) # U with acute
nesi_individuals_with_grants_2011 <- as.data.frame(lapply(nesi_individuals_with_grants_2011, function(x) gsub("\xf1", "\u00f1", x))) # n with tilde
nesi_individuals_with_grants_2011 <- as.data.frame(lapply(nesi_individuals_with_grants_2011, function(x) gsub("<f1>", "\u00f1", x))) # n with tilde
nesi_individuals_with_grants_2011 <- as.data.frame(lapply(nesi_individuals_with_grants_2011, function(x) gsub("\xfc\xbe\x8c\x96\x98\xbc", "\u00f1", x))) # n with tilde
nesi_individuals_with_grants_2011 <- as.data.frame(lapply(nesi_individuals_with_grants_2011, function(x) gsub("\xd1", "\u00d1", x))) # N with tilde
nesi_individuals_with_grants_2011 <- as.data.frame(lapply(nesi_individuals_with_grants_2011, function(x) gsub("<d1>", "\u00d1", x))) # N with tilde
nesi_individuals_with_grants_2011 <- as.data.frame(lapply(nesi_individuals_with_grants_2011, function(x) gsub("\xfc\xbe\x8c\x96\x90\xbc", "\u00d1", x))) # N with tilde
nesi_individuals_with_grants_2011 <- as.data.frame(lapply(nesi_individuals_with_grants_2011, function(x) gsub("\xb4", "\u0027", x))) # apostrophe
nesi_individuals_with_grants_2011 <- as.data.frame(lapply(nesi_individuals_with_grants_2011, function(x) gsub("<b4>", "\u0027", x))) # apostrophe
nesi_individuals_with_grants_2011 <- as.data.frame(lapply(nesi_individuals_with_grants_2011, function(x) gsub(" De ", " de ", x)))
nesi_individuals_with_grants_2011 <- as.data.frame(lapply(nesi_individuals_with_grants_2011, function(x) gsub(" Del ", " del ", x)))
nesi_individuals_with_grants_2011 <- as.data.frame(lapply(nesi_individuals_with_grants_2011, function(x) gsub(" La ", " la ", x)))
nesi_individuals_with_grants_2011 <- as.data.frame(lapply(nesi_individuals_with_grants_2011, function(x) gsub(" Los ", " los ", x)))
nesi_individuals_with_grants_2011 <- as.data.frame(lapply(nesi_individuals_with_grants_2011, function(x) gsub(" Y ", " y ", x)))
unique(subset(nesi_individuals_with_grants_2011$comuna_name, !(nesi_individuals_with_grants_2011$comuna_name %in% regiones_casen_2015$comuna_name)))
unique(subset(nesi_individuals_with_grants_2011$R_P_C, !(nesi_individuals_with_grants_2011$R_P_C %in% region_codes_datachile$comuna_name)))
nesi_individuals_with_grants_2011 <- as.data.frame(lapply(nesi_individuals_with_grants_2011, function(x) gsub("Los Alamos", "Los \u00c1lamos", x)))
nesi_individuals_with_grants_2011 <- as.data.frame(lapply(nesi_individuals_with_grants_2011, function(x) gsub("Los Angeles", "Los \u00c1ngeles", x)))
nesi_individuals_with_grants_2011 <- as.data.frame(lapply(nesi_individuals_with_grants_2011, function(x) gsub("Quilpue", "Quilpu\u00e9", x)))
nesi_individuals_with_grants_2011 <- as.data.frame(lapply(nesi_individuals_with_grants_2011, function(x) gsub("TALCAHUANO", "Talcahuano", x)))
nesi_individuals_with_grants_2011 <- as.data.frame(lapply(nesi_individuals_with_grants_2011, function(x) gsub("TRAIGUEN", "Traigu\u00e9n", x)))
nesi_individuals_with_grants_2011 <- as.data.frame(lapply(nesi_individuals_with_grants_2011, function(x) gsub("VILLARRICA", "Villarrica", x)))
nesi_individuals_with_grants_2011 <- as.data.frame(lapply(nesi_individuals_with_grants_2011, function(x) gsub("Coihaique", "Coyhaique", x)))
nesi_individuals_with_grants_2011 <- as.data.frame(lapply(nesi_individuals_with_grants_2011, function(x) gsub("Ais\u00e9n", "Ays\u00e9n", x)))
nesi_individuals_with_grants_2011 <- as.data.frame(lapply(nesi_individuals_with_grants_2011, function(x) gsub("SAN MIGUEL", "San Miguel", x)))
nesi_individuals_with_grants_2011 <- as.data.frame(lapply(nesi_individuals_with_grants_2011, function(x) gsub("LA FLORIDA", "La Florida", x)))
nesi_individuals_with_grants_2011 <- as.data.frame(lapply(nesi_individuals_with_grants_2011, function(x) gsub("\u00d1U\u00d1OA", "\u00d1u\u00f1oa", x)))
nesi_individuals_with_grants_2011 <- as.data.frame(lapply(nesi_individuals_with_grants_2011, function(x) gsub("PAILLACO", "Paillaco", x)))
unique(subset(nesi_individuals_with_grants_2011$comuna_name, !(nesi_individuals_with_grants_2011$comuna_name %in% regiones_casen_2015$comuna_name)))
unique(subset(nesi_individuals_with_grants_2011$R_P_C, !(nesi_individuals_with_grants_2011$R_P_C %in% region_codes_datachile$comuna_name)))
setnames(nesi_individuals_with_grants_2011, colnames(nesi_individuals_with_grants_2011),
c("wage", "weight", "occupational_situation", "sex", "comuna_name", "icse", "year"))
# Move year
nesi_individuals_with_grants_2011 <- move_col(nesi_individuals_with_grants_2011, c("year" = 1))
# Add region and provincia
nesi_individuals_with_grants_2011 <- move_col(nesi_individuals_with_grants_2011, c("comuna_name" = ncol(nesi_individuals_with_grants_2011)))
nesi_individuals_with_grants_2011 <- join(nesi_individuals_with_grants_2011, regiones_casen_2015, by = "comuna_name")
nesi_individuals_with_grants_2011 <- join(nesi_individuals_with_grants_2011, region_codes_datachile[,c("comuna_name","comuna_datachile_id")], by = "comuna_name")
nesi_individuals_with_grants_2011 <- join(nesi_individuals_with_grants_2011, region_codes_datachile[,c("region_name","region_id")], by = "region_name")
nesi_individuals_with_grants_2011 <- join(nesi_individuals_with_grants_2011, provincia_codes_pacha[,c("provincia_name","provincia_pacha_id")], by = "provincia_name")
# Paste the relevant columns
nesi_individuals_with_grants_2012 <- nesi_individuals_with_grants_2012[,c("ING_T_P", "FACT_PER", "OCUP_REF", "SEXO", "R_P_C", "CISE")]
nesi_individuals_with_grants_2012$YEAR <- 2012
# Keep only the people that reported their wage
nesi_individuals_with_grants_2012$ING_T_P <- as.numeric(as.character(nesi_individuals_with_grants_2012$ING_T_P))
nesi_individuals_with_grants_2012 <- subset(nesi_individuals_with_grants_2012, nesi_individuals_with_grants_2012$ING_T_P > 0)
nesi_individuals_with_grants_2012$FACT_PER <- as.numeric(as.character(nesi_individuals_with_grants_2012$FACT_PER))
nesi_individuals_with_grants_2012$YEAR <- as.numeric(as.character(nesi_individuals_with_grants_2012$YEAR))
# Trim leading/ending whitespace + Fix characters/uppercase
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("(^|[[:space:]])([[:alpha:]])", "\\1\\U\\2", x, perl=TRUE)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function (x) gsub("^\\s+|\\s+$", "", x)))
# Fix characters/uppercase
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xe1", "\u00e1", x))) # a with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<e1>", "\u00e1", x))) # a with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<c1>", "\u00c1", x))) # A with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xe9", "\u00e9", x))) # e with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<e9>", "\u00e9", x))) # e with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xed", "\u00ed", x))) # i with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<ed>", "\u00ed", x))) # i with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xf3", "\u00f3", x))) # o with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<f3>", "\u00f3", x))) # o with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xfa", "\u00fa", x))) # u with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<fa>", "\u00fa", x))) # u with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xda", "\u00da", x))) # U with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<da>", "\u00da", x))) # U with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xf1", "\u00f1", x))) # n with tilde
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<f1>", "\u00f1", x))) # n with tilde
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xfc\xbe\x8c\x96\x98\xbc", "\u00f1", x))) # n with tilde
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xd1", "\u00d1", x))) # N with tilde
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<d1>", "\u00d1", x))) # N with tilde
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xfc\xbe\x8c\x96\x90\xbc", "\u00d1", x))) # N with tilde
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xb4", "\u0027", x))) # apostrophe
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<b4>", "\u0027", x))) # apostrophe
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub(" De ", " de ", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub(" Del ", " del ", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub(" La ", " la ", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub(" Los ", " los ", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub(" Y ", " y ", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("Los Alamos", "Los \u00c1lamos", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("Los Angeles", "Los \u00c1ngeles", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("Quilpue", "Quilpu\u00e9", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("TALCAHUANO", "Talcahuano", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("TRAIGUEN", "Traigu\u00e9n", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("VILLARRICA", "Villarrica", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("Coihaique", "Coyhaique", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("Ais\u00e9n", "Ays\u00e9n", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("SAN MIGUEL", "San Miguel", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("LA FLORIDA", "La Florida", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\u00d1U\u00d1OA", "\u00d1u\u00f1oa", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("PAILLACO", "Paillaco", x)))
unique(subset(nesi_individuals_with_grants_2012$comuna_name, !(nesi_individuals_with_grants_2012$comuna_name %in% regiones_casen_2015$comuna_name)))
unique(subset(nesi_individuals_with_grants_2012$R_P_C, !(nesi_individuals_with_grants_2012$R_P_C %in% region_codes_datachile$comuna_name)))
load("~/datachile-etl/nesi/nesi_2012/individuals/nesi_individuals_with_grants_2012.RData")
# Paste the relevant columns
nesi_individuals_with_grants_2012 <- nesi_individuals_with_grants_2012[,c("ING_T_P", "FACT_PER", "OCUP_REF", "SEXO", "R_P_C", "CISE")]
nesi_individuals_with_grants_2012$YEAR <- 2012
# Keep only the people that reported their wage
nesi_individuals_with_grants_2012$ING_T_P <- as.numeric(as.character(nesi_individuals_with_grants_2012$ING_T_P))
nesi_individuals_with_grants_2012 <- subset(nesi_individuals_with_grants_2012, nesi_individuals_with_grants_2012$ING_T_P > 0)
nesi_individuals_with_grants_2012$FACT_PER <- as.numeric(as.character(nesi_individuals_with_grants_2012$FACT_PER))
nesi_individuals_with_grants_2012$YEAR <- as.numeric(as.character(nesi_individuals_with_grants_2012$YEAR))
# Trim leading/ending whitespace + Fix characters/uppercase
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("(^|[[:space:]])([[:alpha:]])", "\\1\\U\\2", x, perl=TRUE)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function (x) gsub("^\\s+|\\s+$", "", x)))
# Fix characters/uppercase
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xe1", "\u00e1", x))) # a with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<e1>", "\u00e1", x))) # a with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<c1>", "\u00c1", x))) # A with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xe9", "\u00e9", x))) # e with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<e9>", "\u00e9", x))) # e with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xed", "\u00ed", x))) # i with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<ed>", "\u00ed", x))) # i with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xf3", "\u00f3", x))) # o with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<f3>", "\u00f3", x))) # o with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xfa", "\u00fa", x))) # u with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<fa>", "\u00fa", x))) # u with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xda", "\u00da", x))) # U with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<da>", "\u00da", x))) # U with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xf1", "\u00f1", x))) # n with tilde
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<f1>", "\u00f1", x))) # n with tilde
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xfc\xbe\x8c\x96\x98\xbc", "\u00f1", x))) # n with tilde
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xd1", "\u00d1", x))) # N with tilde
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<d1>", "\u00d1", x))) # N with tilde
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xfc\xbe\x8c\x96\x90\xbc", "\u00d1", x))) # N with tilde
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xb4", "\u0027", x))) # apostrophe
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<b4>", "\u0027", x))) # apostrophe
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub(" De ", " de ", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub(" Del ", " del ", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub(" La ", " la ", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub(" Los ", " los ", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub(" Y ", " y ", x)))
unique(subset(nesi_individuals_with_grants_2012$comuna_name, !(nesi_individuals_with_grants_2012$comuna_name %in% regiones_casen_2015$comuna_name)))
unique(subset(nesi_individuals_with_grants_2012$R_P_C, !(nesi_individuals_with_grants_2012$R_P_C %in% region_codes_datachile$comuna_name)))
View(regiones_casen_2015)
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("Los Alamos", "Los \u00c1lamos", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("Los Angeles", "Los \u00c1ngeles", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("Quilpue", "Quilpu\u00e9", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("TALCAHUANO", "Talcahuano", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("TRAIGUEN", "Traigu\u00e9n", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("VILLARRICA", "Villarrica", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("Coihaique", "Coyhaique", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("Ais\u00e9n", "Ays\u00e9n", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("SAN MIGUEL", "San Miguel", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("LA FLORIDA", "La Florida", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\u00d1U\u00d1OA", "\u00d1u\u00f1oa", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("PAILLACO", "Paillaco", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("MOSTAZAL", "Mostazal", x)))
unique(subset(nesi_individuals_with_grants_2012$comuna_name, !(nesi_individuals_with_grants_2012$comuna_name %in% regiones_casen_2015$comuna_name)))
unique(subset(nesi_individuals_with_grants_2012$R_P_C, !(nesi_individuals_with_grants_2012$R_P_C %in% region_codes_datachile$comuna_name)))
setnames(nesi_individuals_with_grants_2012, colnames(nesi_individuals_with_grants_2012),
c("wage", "weight", "occupational_situation", "sex", "comuna_name", "icse", "year"))
# Move year
nesi_individuals_with_grants_2012 <- move_col(nesi_individuals_with_grants_2012, c("year" = 1))
# Add region and provincia
nesi_individuals_with_grants_2012 <- move_col(nesi_individuals_with_grants_2012, c("comuna_name" = ncol(nesi_individuals_with_grants_2012)))
nesi_individuals_with_grants_2012 <- join(nesi_individuals_with_grants_2012, regiones_casen_2015, by = "comuna_name")
nesi_individuals_with_grants_2012 <- join(nesi_individuals_with_grants_2012, region_codes_datachile[,c("comuna_name","comuna_datachile_id")], by = "comuna_name")
nesi_individuals_with_grants_2012 <- join(nesi_individuals_with_grants_2012, region_codes_datachile[,c("region_name","region_id")], by = "region_name")
nesi_individuals_with_grants_2012 <- join(nesi_individuals_with_grants_2012, provincia_codes_pacha[,c("provincia_name","provincia_pacha_id")], by = "provincia_name")
dim(nesi_individuals_with_grants_2012)
View(provincia_codes_pacha)
View(region_codes_datachile)
View(regiones_casen_2015)
load("~/datachile-etl/nesi/nesi_2012/individuals/nesi_individuals_with_grants_2012.RData")
# Paste the relevant columns
nesi_individuals_with_grants_2012 <- nesi_individuals_with_grants_2012[,c("ING_T_P", "FACT_PER", "OCUP_REF", "SEXO", "R_P_C", "CISE")]
nesi_individuals_with_grants_2012$YEAR <- 2012
# Keep only the people that reported their wage
nesi_individuals_with_grants_2012$ING_T_P <- as.numeric(as.character(nesi_individuals_with_grants_2012$ING_T_P))
nesi_individuals_with_grants_2012 <- subset(nesi_individuals_with_grants_2012, nesi_individuals_with_grants_2012$ING_T_P > 0)
nesi_individuals_with_grants_2012$FACT_PER <- as.numeric(as.character(nesi_individuals_with_grants_2012$FACT_PER))
nesi_individuals_with_grants_2012$YEAR <- as.numeric(as.character(nesi_individuals_with_grants_2012$YEAR))
# Trim leading/ending whitespace + Fix characters/uppercase
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("(^|[[:space:]])([[:alpha:]])", "\\1\\U\\2", x, perl=TRUE)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function (x) gsub("^\\s+|\\s+$", "", x)))
# Fix characters/uppercase
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xe1", "\u00e1", x))) # a with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<e1>", "\u00e1", x))) # a with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<c1>", "\u00c1", x))) # A with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xe9", "\u00e9", x))) # e with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<e9>", "\u00e9", x))) # e with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xed", "\u00ed", x))) # i with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<ed>", "\u00ed", x))) # i with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xf3", "\u00f3", x))) # o with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<f3>", "\u00f3", x))) # o with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xfa", "\u00fa", x))) # u with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<fa>", "\u00fa", x))) # u with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xda", "\u00da", x))) # U with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<da>", "\u00da", x))) # U with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xf1", "\u00f1", x))) # n with tilde
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<f1>", "\u00f1", x))) # n with tilde
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xfc\xbe\x8c\x96\x98\xbc", "\u00f1", x))) # n with tilde
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xd1", "\u00d1", x))) # N with tilde
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<d1>", "\u00d1", x))) # N with tilde
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xfc\xbe\x8c\x96\x90\xbc", "\u00d1", x))) # N with tilde
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xb4", "\u0027", x))) # apostrophe
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<b4>", "\u0027", x))) # apostrophe
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub(" De ", " de ", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub(" Del ", " del ", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub(" La ", " la ", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub(" Los ", " los ", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub(" Y ", " y ", x)))
# Fix comuna
#unique(subset(nesi_individuals_with_grants_2012$comuna_name, !(nesi_individuals_with_grants_2012$comuna_name %in% regiones_casen_2015$comuna_name)))
#unique(subset(nesi_individuals_with_grants_2012$R_P_C, !(nesi_individuals_with_grants_2012$R_P_C %in% region_codes_datachile$comuna_name)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("Los Alamos", "Los \u00c1lamos", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("Los Angeles", "Los \u00c1ngeles", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("Quilpue", "Quilpu\u00e9", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("TALCAHUANO", "Talcahuano", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("TRAIGUEN", "Traigu\u00e9n", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("VILLARRICA", "Villarrica", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("Coihaique", "Coyhaique", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("Ais\u00e9n", "Ays\u00e9n", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("SAN MIGUEL", "San Miguel", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("LA FLORIDA", "La Florida", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\u00d1U\u00d1OA", "\u00d1u\u00f1oa", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("PAILLACO", "Paillaco", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("MOSTAZAL", "Mostazal", x)))
# Fix colnames
setnames(nesi_individuals_with_grants_2012, colnames(nesi_individuals_with_grants_2012),
c("wage", "weight", "occupational_situation", "sex", "comuna_name", "icse", "year"))
# Move year
nesi_individuals_with_grants_2012 <- move_col(nesi_individuals_with_grants_2012, c("year" = 1))
View(nesi_individuals_with_grants_2012)
nesi_individuals_with_grants_2012 <- move_col(nesi_individuals_with_grants_2012, c("comuna_name" = ncol(nesi_individuals_with_grants_2012)))
nesi_individuals_with_grants_2012 <- join(nesi_individuals_with_grants_2012, regiones_casen_2015, by = "comuna_name")
nesi_individuals_with_grants_2012 <- join(nesi_individuals_with_grants_2012, region_codes_datachile[,c("comuna_name","comuna_datachile_id")], by = "comuna_name")
nesi_individuals_with_grants_2012 <- join(nesi_individuals_with_grants_2012, region_codes_datachile[,c("region_name","region_id")], by = "region_name")
load("~/datachile-etl/nesi/nesi_2012/individuals/nesi_individuals_with_grants_2012.RData")
# Paste the relevant columns
nesi_individuals_with_grants_2012 <- nesi_individuals_with_grants_2012[,c("ING_T_P", "FACT_PER", "OCUP_REF", "SEXO", "R_P_C", "CISE")]
nesi_individuals_with_grants_2012$YEAR <- 2012
# Keep only the people that reported their wage
nesi_individuals_with_grants_2012$ING_T_P <- as.numeric(as.character(nesi_individuals_with_grants_2012$ING_T_P))
nesi_individuals_with_grants_2012 <- subset(nesi_individuals_with_grants_2012, nesi_individuals_with_grants_2012$ING_T_P > 0)
nesi_individuals_with_grants_2012$FACT_PER <- as.numeric(as.character(nesi_individuals_with_grants_2012$FACT_PER))
nesi_individuals_with_grants_2012$YEAR <- as.numeric(as.character(nesi_individuals_with_grants_2012$YEAR))
# Trim leading/ending whitespace + Fix characters/uppercase
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("(^|[[:space:]])([[:alpha:]])", "\\1\\U\\2", x, perl=TRUE)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function (x) gsub("^\\s+|\\s+$", "", x)))
# Fix characters/uppercase
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xe1", "\u00e1", x))) # a with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<e1>", "\u00e1", x))) # a with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<c1>", "\u00c1", x))) # A with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xe9", "\u00e9", x))) # e with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<e9>", "\u00e9", x))) # e with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xed", "\u00ed", x))) # i with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<ed>", "\u00ed", x))) # i with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xf3", "\u00f3", x))) # o with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<f3>", "\u00f3", x))) # o with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xfa", "\u00fa", x))) # u with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<fa>", "\u00fa", x))) # u with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xda", "\u00da", x))) # U with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<da>", "\u00da", x))) # U with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xf1", "\u00f1", x))) # n with tilde
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<f1>", "\u00f1", x))) # n with tilde
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xfc\xbe\x8c\x96\x98\xbc", "\u00f1", x))) # n with tilde
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xd1", "\u00d1", x))) # N with tilde
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<d1>", "\u00d1", x))) # N with tilde
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xfc\xbe\x8c\x96\x90\xbc", "\u00d1", x))) # N with tilde
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xb4", "\u0027", x))) # apostrophe
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<b4>", "\u0027", x))) # apostrophe
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub(" De ", " de ", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub(" Del ", " del ", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub(" La ", " la ", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub(" Los ", " los ", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub(" Y ", " y ", x)))
# Fix comuna
#unique(subset(nesi_individuals_with_grants_2012$comuna_name, !(nesi_individuals_with_grants_2012$comuna_name %in% regiones_casen_2015$comuna_name)))
#unique(subset(nesi_individuals_with_grants_2012$R_P_C, !(nesi_individuals_with_grants_2012$R_P_C %in% region_codes_datachile$comuna_name)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("Los Alamos", "Los \u00c1lamos", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("Los Angeles", "Los \u00c1ngeles", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("Quilpue", "Quilpu\u00e9", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("TALCAHUANO", "Talcahuano", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("TRAIGUEN", "Traigu\u00e9n", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("VILLARRICA", "Villarrica", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("Coihaique", "Coyhaique", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("Ais\u00e9n", "Ays\u00e9n", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("SAN MIGUEL", "San Miguel", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("LA FLORIDA", "La Florida", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\u00d1U\u00d1OA", "\u00d1u\u00f1oa", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("PAILLACO", "Paillaco", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("MOSTAZAL", "Mostazal", x)))
# Fix colnames
setnames(nesi_individuals_with_grants_2012, colnames(nesi_individuals_with_grants_2012),
c("wage", "weight", "occupational_situation", "sex", "comuna_name", "icse", "year"))
# Move year
nesi_individuals_with_grants_2012 <- move_col(nesi_individuals_with_grants_2012, c("year" = 1))
# Add region and provincia
nesi_individuals_with_grants_2012 <- move_col(nesi_individuals_with_grants_2012, c("comuna_name" = ncol(nesi_individuals_with_grants_2012)))
nesi_individuals_with_grants_2012 <- join(nesi_individuals_with_grants_2012, regiones_casen_2015, by = "comuna_name")
nesi_individuals_with_grants_2012 <- join(nesi_individuals_with_grants_2012, region_codes_datachile[,c("comuna_name","comuna_datachile_id","region_name","region_id")], by = "comuna_name")
View(nesi_individuals_with_grants_2012)
nesi_individuals_with_grants_2012 <- join(nesi_individuals_with_grants_2012, provincia_codes_pacha[,c("provincia_name","provincia_pacha_id")], by = "provincia_name")
names(nesi_individuals_with_grants_2012)
load("~/datachile-etl/nesi/nesi_2012/individuals/nesi_individuals_with_grants_2012.RData")
# Paste the relevant columns
nesi_individuals_with_grants_2012 <- nesi_individuals_with_grants_2012[,c("ING_T_P", "FACT_PER", "OCUP_REF", "SEXO", "R_P_C", "CISE")]
nesi_individuals_with_grants_2012$YEAR <- 2012
# Keep only the people that reported their wage
nesi_individuals_with_grants_2012$ING_T_P <- as.numeric(as.character(nesi_individuals_with_grants_2012$ING_T_P))
nesi_individuals_with_grants_2012 <- subset(nesi_individuals_with_grants_2012, nesi_individuals_with_grants_2012$ING_T_P > 0)
nesi_individuals_with_grants_2012$FACT_PER <- as.numeric(as.character(nesi_individuals_with_grants_2012$FACT_PER))
nesi_individuals_with_grants_2012$YEAR <- as.numeric(as.character(nesi_individuals_with_grants_2012$YEAR))
# Trim leading/ending whitespace + Fix characters/uppercase
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("(^|[[:space:]])([[:alpha:]])", "\\1\\U\\2", x, perl=TRUE)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function (x) gsub("^\\s+|\\s+$", "", x)))
# Fix characters/uppercase
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xe1", "\u00e1", x))) # a with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<e1>", "\u00e1", x))) # a with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<c1>", "\u00c1", x))) # A with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xe9", "\u00e9", x))) # e with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<e9>", "\u00e9", x))) # e with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xed", "\u00ed", x))) # i with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<ed>", "\u00ed", x))) # i with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xf3", "\u00f3", x))) # o with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<f3>", "\u00f3", x))) # o with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xfa", "\u00fa", x))) # u with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<fa>", "\u00fa", x))) # u with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xda", "\u00da", x))) # U with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<da>", "\u00da", x))) # U with acute
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xf1", "\u00f1", x))) # n with tilde
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<f1>", "\u00f1", x))) # n with tilde
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xfc\xbe\x8c\x96\x98\xbc", "\u00f1", x))) # n with tilde
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xd1", "\u00d1", x))) # N with tilde
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<d1>", "\u00d1", x))) # N with tilde
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xfc\xbe\x8c\x96\x90\xbc", "\u00d1", x))) # N with tilde
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\xb4", "\u0027", x))) # apostrophe
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("<b4>", "\u0027", x))) # apostrophe
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub(" De ", " de ", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub(" Del ", " del ", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub(" La ", " la ", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub(" Los ", " los ", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub(" Y ", " y ", x)))
# Fix comuna
#unique(subset(nesi_individuals_with_grants_2012$comuna_name, !(nesi_individuals_with_grants_2012$comuna_name %in% regiones_casen_2015$comuna_name)))
#unique(subset(nesi_individuals_with_grants_2012$R_P_C, !(nesi_individuals_with_grants_2012$R_P_C %in% region_codes_datachile$comuna_name)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("Los Alamos", "Los \u00c1lamos", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("Los Angeles", "Los \u00c1ngeles", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("Quilpue", "Quilpu\u00e9", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("TALCAHUANO", "Talcahuano", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("TRAIGUEN", "Traigu\u00e9n", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("VILLARRICA", "Villarrica", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("Coihaique", "Coyhaique", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("Ais\u00e9n", "Ays\u00e9n", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("SAN MIGUEL", "San Miguel", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("LA FLORIDA", "La Florida", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("\u00d1U\u00d1OA", "\u00d1u\u00f1oa", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("PAILLACO", "Paillaco", x)))
nesi_individuals_with_grants_2012 <- as.data.frame(lapply(nesi_individuals_with_grants_2012, function(x) gsub("MOSTAZAL", "Mostazal", x)))
# Fix colnames
setnames(nesi_individuals_with_grants_2012, colnames(nesi_individuals_with_grants_2012),
c("wage", "weight", "occupational_situation", "sex", "comuna_name", "icse", "year"))
# Move year
nesi_individuals_with_grants_2012 <- move_col(nesi_individuals_with_grants_2012, c("year" = 1))
# Add region and provincia
nesi_individuals_with_grants_2012 <- move_col(nesi_individuals_with_grants_2012, c("comuna_name" = ncol(nesi_individuals_with_grants_2012)))
nesi_individuals_with_grants_2012 <- join(nesi_individuals_with_grants_2012, regiones_casen_2015, by = "comuna_name")
nesi_individuals_with_grants_2012 <- join(nesi_individuals_with_grants_2012, region_codes_datachile[,c("comuna_name","comuna_datachile_id","region_id")], by = "comuna_name")
nesi_individuals_with_grants_2012 <- join(nesi_individuals_with_grants_2012, provincia_codes_pacha[,c("provincia_name","provincia_pacha_id")], by = "provincia_name")
names(nesi_individuals_with_grants_2012)
source("functions/load_functions.R")
source("functions/batch_load_data.R")
source("functions/normalization.R")
source("process_wages_with_weights/process_wages_with_weights_2015.R")
source("process_wages_with_weights/process_wages_with_weights_2010.R")
source("process_wages_with_weights/process_wages_with_weights_2011.R")
source("process_wages_with_weights/process_wages_with_weights_2012.R")
# Paste the relevant columns
nesi_individuals_with_grants_2013 <- nesi_individuals_with_grants_2013[,c("ING_T_P", "FACT_PER", "OCUP_REF", "SEXO", "R_P_C", "CISE")]
nesi_individuals_with_grants_2013$YEAR <- 2013
# Keep only the people that reported their wage
nesi_individuals_with_grants_2013$ING_T_P <- as.numeric(as.character(nesi_individuals_with_grants_2013$ING_T_P))
nesi_individuals_with_grants_2013 <- subset(nesi_individuals_with_grants_2013, nesi_individuals_with_grants_2013$ING_T_P > 0)
nesi_individuals_with_grants_2013$FACT_PER <- as.numeric(as.character(nesi_individuals_with_grants_2013$FACT_PER))
nesi_individuals_with_grants_2013$YEAR <- as.numeric(as.character(nesi_individuals_with_grants_2013$YEAR))
# Trim leading/ending whitespace + Fix characters/uppercase
nesi_individuals_with_grants_2013 <- as.data.frame(lapply(nesi_individuals_with_grants_2013, function(x) gsub("(^|[[:space:]])([[:alpha:]])", "\\1\\U\\2", x, perl=TRUE)))
nesi_individuals_with_grants_2013 <- as.data.frame(lapply(nesi_individuals_with_grants_2013, function (x) gsub("^\\s+|\\s+$", "", x)))
# Fix characters/uppercase
nesi_individuals_with_grants_2013 <- as.data.frame(lapply(nesi_individuals_with_grants_2013, function(x) gsub("\xe1", "\u00e1", x))) # a with acute
nesi_individuals_with_grants_2013 <- as.data.frame(lapply(nesi_individuals_with_grants_2013, function(x) gsub("<e1>", "\u00e1", x))) # a with acute
nesi_individuals_with_grants_2013 <- as.data.frame(lapply(nesi_individuals_with_grants_2013, function(x) gsub("<c1>", "\u00c1", x))) # A with acute
nesi_individuals_with_grants_2013 <- as.data.frame(lapply(nesi_individuals_with_grants_2013, function(x) gsub("\xe9", "\u00e9", x))) # e with acute
nesi_individuals_with_grants_2013 <- as.data.frame(lapply(nesi_individuals_with_grants_2013, function(x) gsub("<e9>", "\u00e9", x))) # e with acute
nesi_individuals_with_grants_2013 <- as.data.frame(lapply(nesi_individuals_with_grants_2013, function(x) gsub("\xed", "\u00ed", x))) # i with acute
nesi_individuals_with_grants_2013 <- as.data.frame(lapply(nesi_individuals_with_grants_2013, function(x) gsub("<ed>", "\u00ed", x))) # i with acute
nesi_individuals_with_grants_2013 <- as.data.frame(lapply(nesi_individuals_with_grants_2013, function(x) gsub("\xf3", "\u00f3", x))) # o with acute
nesi_individuals_with_grants_2013 <- as.data.frame(lapply(nesi_individuals_with_grants_2013, function(x) gsub("<f3>", "\u00f3", x))) # o with acute
nesi_individuals_with_grants_2013 <- as.data.frame(lapply(nesi_individuals_with_grants_2013, function(x) gsub("\xfa", "\u00fa", x))) # u with acute
nesi_individuals_with_grants_2013 <- as.data.frame(lapply(nesi_individuals_with_grants_2013, function(x) gsub("<fa>", "\u00fa", x))) # u with acute
nesi_individuals_with_grants_2013 <- as.data.frame(lapply(nesi_individuals_with_grants_2013, function(x) gsub("\xda", "\u00da", x))) # U with acute
nesi_individuals_with_grants_2013 <- as.data.frame(lapply(nesi_individuals_with_grants_2013, function(x) gsub("<da>", "\u00da", x))) # U with acute
nesi_individuals_with_grants_2013 <- as.data.frame(lapply(nesi_individuals_with_grants_2013, function(x) gsub("\xf1", "\u00f1", x))) # n with tilde
nesi_individuals_with_grants_2013 <- as.data.frame(lapply(nesi_individuals_with_grants_2013, function(x) gsub("<f1>", "\u00f1", x))) # n with tilde
nesi_individuals_with_grants_2013 <- as.data.frame(lapply(nesi_individuals_with_grants_2013, function(x) gsub("\xfc\xbe\x8c\x96\x98\xbc", "\u00f1", x))) # n with tilde
nesi_individuals_with_grants_2013 <- as.data.frame(lapply(nesi_individuals_with_grants_2013, function(x) gsub("\xd1", "\u00d1", x))) # N with tilde
nesi_individuals_with_grants_2013 <- as.data.frame(lapply(nesi_individuals_with_grants_2013, function(x) gsub("<d1>", "\u00d1", x))) # N with tilde
nesi_individuals_with_grants_2013 <- as.data.frame(lapply(nesi_individuals_with_grants_2013, function(x) gsub("\xfc\xbe\x8c\x96\x90\xbc", "\u00d1", x))) # N with tilde
nesi_individuals_with_grants_2013 <- as.data.frame(lapply(nesi_individuals_with_grants_2013, function(x) gsub("\xb4", "\u0027", x))) # apostrophe
nesi_individuals_with_grants_2013 <- as.data.frame(lapply(nesi_individuals_with_grants_2013, function(x) gsub("<b4>", "\u0027", x))) # apostrophe
nesi_individuals_with_grants_2013 <- as.data.frame(lapply(nesi_individuals_with_grants_2013, function(x) gsub(" De ", " de ", x)))
nesi_individuals_with_grants_2013 <- as.data.frame(lapply(nesi_individuals_with_grants_2013, function(x) gsub(" Del ", " del ", x)))
nesi_individuals_with_grants_2013 <- as.data.frame(lapply(nesi_individuals_with_grants_2013, function(x) gsub(" La ", " la ", x)))
nesi_individuals_with_grants_2013 <- as.data.frame(lapply(nesi_individuals_with_grants_2013, function(x) gsub(" Los ", " los ", x)))
nesi_individuals_with_grants_2013 <- as.data.frame(lapply(nesi_individuals_with_grants_2013, function(x) gsub(" Y ", " y ", x)))
unique(subset(nesi_individuals_with_grants_2013$comuna_name, !(nesi_individuals_with_grants_2013$comuna_name %in% regiones_casen_2015$comuna_name)))
unique(subset(nesi_individuals_with_grants_2013$R_P_C, !(nesi_individuals_with_grants_2013$R_P_C %in% region_codes_datachile$comuna_name)))
nesi_individuals_with_grants_2013 <- as.data.frame(lapply(nesi_individuals_with_grants_2013, function(x) gsub("Los Alamos", "Los \u00c1lamos", x)))
nesi_individuals_with_grants_2013 <- as.data.frame(lapply(nesi_individuals_with_grants_2013, function(x) gsub("Los Angeles", "Los \u00c1ngeles", x)))
nesi_individuals_with_grants_2013 <- as.data.frame(lapply(nesi_individuals_with_grants_2013, function(x) gsub("TRAIGUEN", "Traigu\u00e9n", x)))
# Fix colnames
setnames(nesi_individuals_with_grants_2013, colnames(nesi_individuals_with_grants_2013),
c("wage", "weight", "occupational_situation", "sex", "comuna_name", "icse", "year"))
# Move year
nesi_individuals_with_grants_2013 <- move_col(nesi_individuals_with_grants_2013, c("year" = 1))
# Add region and provincia
nesi_individuals_with_grants_2013 <- move_col(nesi_individuals_with_grants_2013, c("comuna_name" = ncol(nesi_individuals_with_grants_2013)))
nesi_individuals_with_grants_2013 <- join(nesi_individuals_with_grants_2013, regiones_casen_2015, by = "comuna_name")
nesi_individuals_with_grants_2013 <- join(nesi_individuals_with_grants_2013, region_codes_datachile[,c("comuna_name","comuna_datachile_id","region_id")], by = "comuna_name")
nesi_individuals_with_grants_2013 <- join(nesi_individuals_with_grants_2013, provincia_codes_pacha[,c("provincia_name","provincia_pacha_id")], by = "provincia_name")
# Paste the relevant columns
nesi_individuals_with_grants_2014 <- nesi_individuals_with_grants_2014[,c("ING_T_P", "FACT_PER", "OCUP_REF", "SEXO", "R_P_C", "CISE")]
nesi_individuals_with_grants_2014$YEAR <- 2014
# Keep only the people that reported their wage
nesi_individuals_with_grants_2014$ING_T_P <- as.numeric(as.character(nesi_individuals_with_grants_2014$ING_T_P))
nesi_individuals_with_grants_2014 <- subset(nesi_individuals_with_grants_2014, nesi_individuals_with_grants_2014$ING_T_P > 0)
nesi_individuals_with_grants_2014$FACT_PER <- as.numeric(as.character(nesi_individuals_with_grants_2014$FACT_PER))
nesi_individuals_with_grants_2014$YEAR <- as.numeric(as.character(nesi_individuals_with_grants_2014$YEAR))
# Trim leading/ending whitespace + Fix characters/uppercase
nesi_individuals_with_grants_2014 <- as.data.frame(lapply(nesi_individuals_with_grants_2014, function(x) gsub("(^|[[:space:]])([[:alpha:]])", "\\1\\U\\2", x, perl=TRUE)))
nesi_individuals_with_grants_2014 <- as.data.frame(lapply(nesi_individuals_with_grants_2014, function (x) gsub("^\\s+|\\s+$", "", x)))
# Fix characters/uppercase
nesi_individuals_with_grants_2014 <- as.data.frame(lapply(nesi_individuals_with_grants_2014, function(x) gsub("\xe1", "\u00e1", x))) # a with acute
nesi_individuals_with_grants_2014 <- as.data.frame(lapply(nesi_individuals_with_grants_2014, function(x) gsub("<e1>", "\u00e1", x))) # a with acute
nesi_individuals_with_grants_2014 <- as.data.frame(lapply(nesi_individuals_with_grants_2014, function(x) gsub("<c1>", "\u00c1", x))) # A with acute
nesi_individuals_with_grants_2014 <- as.data.frame(lapply(nesi_individuals_with_grants_2014, function(x) gsub("\xe9", "\u00e9", x))) # e with acute
nesi_individuals_with_grants_2014 <- as.data.frame(lapply(nesi_individuals_with_grants_2014, function(x) gsub("<e9>", "\u00e9", x))) # e with acute
nesi_individuals_with_grants_2014 <- as.data.frame(lapply(nesi_individuals_with_grants_2014, function(x) gsub("\xed", "\u00ed", x))) # i with acute
nesi_individuals_with_grants_2014 <- as.data.frame(lapply(nesi_individuals_with_grants_2014, function(x) gsub("<ed>", "\u00ed", x))) # i with acute
nesi_individuals_with_grants_2014 <- as.data.frame(lapply(nesi_individuals_with_grants_2014, function(x) gsub("\xf3", "\u00f3", x))) # o with acute
nesi_individuals_with_grants_2014 <- as.data.frame(lapply(nesi_individuals_with_grants_2014, function(x) gsub("<f3>", "\u00f3", x))) # o with acute
nesi_individuals_with_grants_2014 <- as.data.frame(lapply(nesi_individuals_with_grants_2014, function(x) gsub("\xfa", "\u00fa", x))) # u with acute
nesi_individuals_with_grants_2014 <- as.data.frame(lapply(nesi_individuals_with_grants_2014, function(x) gsub("<fa>", "\u00fa", x))) # u with acute
nesi_individuals_with_grants_2014 <- as.data.frame(lapply(nesi_individuals_with_grants_2014, function(x) gsub("\xda", "\u00da", x))) # U with acute
nesi_individuals_with_grants_2014 <- as.data.frame(lapply(nesi_individuals_with_grants_2014, function(x) gsub("<da>", "\u00da", x))) # U with acute
nesi_individuals_with_grants_2014 <- as.data.frame(lapply(nesi_individuals_with_grants_2014, function(x) gsub("\xf1", "\u00f1", x))) # n with tilde
nesi_individuals_with_grants_2014 <- as.data.frame(lapply(nesi_individuals_with_grants_2014, function(x) gsub("<f1>", "\u00f1", x))) # n with tilde
nesi_individuals_with_grants_2014 <- as.data.frame(lapply(nesi_individuals_with_grants_2014, function(x) gsub("\xfc\xbe\x8c\x96\x98\xbc", "\u00f1", x))) # n with tilde
nesi_individuals_with_grants_2014 <- as.data.frame(lapply(nesi_individuals_with_grants_2014, function(x) gsub("\xd1", "\u00d1", x))) # N with tilde
nesi_individuals_with_grants_2014 <- as.data.frame(lapply(nesi_individuals_with_grants_2014, function(x) gsub("<d1>", "\u00d1", x))) # N with tilde
nesi_individuals_with_grants_2014 <- as.data.frame(lapply(nesi_individuals_with_grants_2014, function(x) gsub("\xfc\xbe\x8c\x96\x90\xbc", "\u00d1", x))) # N with tilde
nesi_individuals_with_grants_2014 <- as.data.frame(lapply(nesi_individuals_with_grants_2014, function(x) gsub("\xb4", "\u0027", x))) # apostrophe
nesi_individuals_with_grants_2014 <- as.data.frame(lapply(nesi_individuals_with_grants_2014, function(x) gsub("<b4>", "\u0027", x))) # apostrophe
nesi_individuals_with_grants_2014 <- as.data.frame(lapply(nesi_individuals_with_grants_2014, function(x) gsub(" De ", " de ", x)))
nesi_individuals_with_grants_2014 <- as.data.frame(lapply(nesi_individuals_with_grants_2014, function(x) gsub(" Del ", " del ", x)))
nesi_individuals_with_grants_2014 <- as.data.frame(lapply(nesi_individuals_with_grants_2014, function(x) gsub(" La ", " la ", x)))
nesi_individuals_with_grants_2014 <- as.data.frame(lapply(nesi_individuals_with_grants_2014, function(x) gsub(" Los ", " los ", x)))
nesi_individuals_with_grants_2014 <- as.data.frame(lapply(nesi_individuals_with_grants_2014, function(x) gsub(" Y ", " y ", x)))
unique(subset(nesi_individuals_with_grants_2014$comuna_name, !(nesi_individuals_with_grants_2014$comuna_name %in% regiones_casen_2015$comuna_name)))
unique(subset(nesi_individuals_with_grants_2014$R_P_C, !(nesi_individuals_with_grants_2014$R_P_C %in% region_codes_datachile$comuna_name)))
nesi_individuals_with_grants_2014 <- as.data.frame(lapply(nesi_individuals_with_grants_2014, function(x) gsub("Los Alamos", "Los \u00c1lamos", x)))
nesi_individuals_with_grants_2014 <- as.data.frame(lapply(nesi_individuals_with_grants_2014, function(x) gsub("Los Angeles", "Los \u00c1ngeles", x)))
nesi_individuals_with_grants_2014 <- as.data.frame(lapply(nesi_individuals_with_grants_2014, function(x) gsub("TRAIGUEN", "Traigu\u00e9n", x)))
# Fix colnames
setnames(nesi_individuals_with_grants_2014, colnames(nesi_individuals_with_grants_2014),
c("wage", "weight", "occupational_situation", "sex", "comuna_name", "icse", "year"))
# Move year
nesi_individuals_with_grants_2014 <- move_col(nesi_individuals_with_grants_2014, c("year" = 1))
# Add region and provincia
nesi_individuals_with_grants_2014 <- move_col(nesi_individuals_with_grants_2014, c("comuna_name" = ncol(nesi_individuals_with_grants_2014)))
nesi_individuals_with_grants_2014 <- join(nesi_individuals_with_grants_2014, regiones_casen_2015, by = "comuna_name")
nesi_individuals_with_grants_2014 <- join(nesi_individuals_with_grants_2014, region_codes_datachile[,c("comuna_name","comuna_datachile_id","region_id")], by = "comuna_name")
nesi_individuals_with_grants_2014 <- join(nesi_individuals_with_grants_2014, provincia_codes_pacha[,c("provincia_name","provincia_pacha_id")], by = "provincia_name")
nesi_individuals_with_grants_tidy <- rbind(nesi_individuals_with_grants_2010,
nesi_individuals_with_grants_2011,
nesi_individuals_with_grants_2012,
nesi_individuals_with_grants_2013,
nesi_individuals_with_grants_2014,
nesi_individuals_with_grants_2015)
rm(nesi_individuals_with_grants_2010,
nesi_individuals_with_grants_2011,
nesi_individuals_with_grants_2012,
nesi_individuals_with_grants_2013,
nesi_individuals_with_grants_2014,
nesi_individuals_with_grants_2015)
source("functions/load_functions.R")
source("functions/batch_load_data.R")
source("functions/normalization.R")
source("process_wages_with_weights/process_wages_with_weights.R")
save(nesi_individuals_with_grants_2010, file = "process_wages_with_weights/nesi_individuals_with_grants_2010.RData")
save(nesi_individuals_with_grants_2011, file = "process_wages_with_weights/nesi_individuals_with_grants_2011.RData")
save(nesi_individuals_with_grants_2012, file = "process_wages_with_weights/nesi_individuals_with_grants_2012.RData")
save(nesi_individuals_with_grants_2013, file = "process_wages_with_weights/nesi_individuals_with_grants_2013.RData")
save(nesi_individuals_with_grants_2014, file = "process_wages_with_weights/nesi_individuals_with_grants_2014.RData")
save(nesi_individuals_with_grants_2015, file = "process_wages_with_weights/nesi_individuals_with_grants_2015.RData")
save(nesi_individuals_with_grants_2010, file = "processed_wages_with_weights/nesi_individuals_with_grants_2010.RData")
save(nesi_individuals_with_grants_2011, file = "processed_wages_with_weights/nesi_individuals_with_grants_2011.RData")
save(nesi_individuals_with_grants_2012, file = "processed_wages_with_weights/nesi_individuals_with_grants_2012.RData")
save(nesi_individuals_with_grants_2013, file = "processed_wages_with_weights/nesi_individuals_with_grants_2013.RData")
save(nesi_individuals_with_grants_2014, file = "processed_wages_with_weights/nesi_individuals_with_grants_2014.RData")
save(nesi_individuals_with_grants_2015, file = "processed_wages_with_weights/nesi_individuals_with_grants_2015.RData")
source("processed_wages_with_weights/load_processed_wages_with_weights.R")
source("functions/load_functions.R")
source("functions/normalization.R")
#source("functions/batch_load_data.R") #uncomment to recalculate from 0
#source("process_wages_with_weights/process_wages_with_weights.R") #uncomment to recalculate from 0
source("processed_wages_with_weights/load_processed_wages_with_weights.R")
