dir.create(folder)
}
if(!file.exists(subfolder)) {
dir.create(subfolder)
}
if(!file.exists(zip)) {
print(paste("downloading data for year", year , "...", sep = " "))
download.file(url, zip, method="curl")
}
if(file.exists(RData)) {
print(paste("importing data for year", year , "...", sep = " "))
nesi_households_with_grants_year <- load(RData)
envir = as.environment(1)
assign(paste("nesi_households_with_grants", year, sep = "_"), nesi_households_with_grants_year, envir = envir)
rm(nesi_households_with_grants_year)
} else {
if(!file.exists(RData) & file.exists(zip)) {
print(paste("decompressing data for year", year , "...", sep = " "))
unzip(zip, exdir = paste("nesi_", year, "/households/", sep = ""))
print(paste("importing data for year", year , "...", sep = " "))
nesi_households_with_grants_year <- load(RData)
envir = as.environment(1)
assign(paste("nesi_households_with_grants", year, sep = "_"), nesi_households_with_grants_year, envir = envir)
rm(nesi_households_with_grants_year)
}
}
load("~/datachile-etl/nesi/nesi_2010/individuals/nesi_individuals_with_grants_2010.RData")
RData
getwd()
source("1_libraries.R")
source("2_load.R")
source("3_batch_load.R")
source("1_libraries.R")
source("2_load.R")
source("3_batch_load.R")
load("~/datachile-etl/nesi/nesi_2010/individuals/nesi_individuals_with_grants_2010.RData")
source("1_libraries.R")
source("2_load.R")
source("3_batch_load.R")
for (i in c(2010:2015)){
individuals_with_grants_load_dataset(i)
}
year <- 2010
RData <- paste0("nesi_", year, "/individuals/nesi_individuals_with_grants_", year, ".RData")
load(RData)
source("1_libraries.R")
source("2_load.R")
source("3_batch_load.R")
all.equal(1,1)
x <- matrix(c(1,2),nrow=2,ncol=1)
x
y <- matrix(c(3,4),nrow=2,ncol=1)
y
rbind(x,y)
cbind(x,y)
knitr::opts_chunk$set(echo = TRUE)
A <- rbind(c(5,0,0,0),c(0,5,0,0),c(1,4,-3,0),c(-1,2,0,-3))
A
diag(A)
d <- diag(A)
P <- eigen(A)$vectors
D <- diag(eigen(m)$values
D <- diag(eigen(A)$values)
D <- diag(eigen(A)$values)
Sys.time(A%*%A,P%*%(D%*%D)%*%solve(P))
Sys.time(A%*%A)
sys.time(A%*%A)
ptm <- proc.time()
A%*%A
proc.time() - ptm
ptm <- proc.time()
P%*%(D%*%D)%*%solve(P)
proc.time() - ptm
ptm <- proc.time()
A%*%A
proc.time() - ptm
ptm <- proc.time()
P%*%(D%*%D)%*%solve(P)
proc.time() - ptm
getwd()
source("1_libraries.R")
source("2_load.R")
source("3_batch_load.R")
str(nesi_individuals_with_grants_2010)
names(nesi_individuals_with_grants_2010)
levels(nesi_individuals_with_grants_2010$REGION)
levels(nesi_individuals_with_grants_2011$REGION)
levels(nesi_individuals_with_grants_2011$REGION) == levels(nesi_individuals_with_grants_2010$REGION)
levels(nesi_individuals_with_grants_2015$REGION)
source("1_libraries.R")
revalue(nesi_individuals_with_grants_2015$REGION, c("Regi\u00f3n de Tarapac\u00e1" = "Tarapac\u00e1",
"Regi\u00f3n de Atacama" = "Atacama",
"Regi\u00f3n de Valpara\u00edso" = "Valpara\u00edso",
"Regi\u00f3n del Maule" = "Maule",
"Regi\u00f3n de la Araucan\u00eda" = "Araucan\u00eda",
"Regi\u00f3n de Ays\u00e9n del Gral. Carlos Ibáñez del Campo" = "Ays\u00e9n",
"Regi\u00f3n Metropolitana de Santiago" = "Metropolitana",
"Regi\u00f3n de Arica y Parinacota" = "Arica y Parinacota",
"Regi\u00f3n de Antofagasta" = "Antofagasta",
"Regi\u00f3n de Coquimbo" = "Coquimbo",
"Regi\u00f3n del Libertador Gral. Bernardo O Higgins" = "O\u0027Higgins",
"Región del Biob\u00edo" = "B\u00edob\u00edo",
"Regi\u00f3n de los Lagos" = "Los Lagos",
"Regi\u00f3n de Magallanes y de la Antártica Chilena" = "Magallanes",
"Regi\u00f3n de los R\u00edos" = "Los R\u00edos"))
nesi_individuals_with_grants_2015$REGION <- revalue(nesi_individuals_with_grants_2015$REGION, c("Regi\u00f3n de Tarapac\u00e1" = "Tarapac\u00e1",
"Regi\u00f3n de Atacama" = "Atacama",
"Regi\u00f3n de Valpara\u00edso" = "Valpara\u00edso",
"Regi\u00f3n del Maule" = "Maule",
"Regi\u00f3n de la Araucan\u00eda" = "Araucan\u00eda",
"Regi\u00f3n de Ays\u00e9n del Gral. Carlos Ibáñez del Campo" = "Ays\u00e9n",
"Regi\u00f3n Metropolitana de Santiago" = "Metropolitana",
"Regi\u00f3n de Arica y Parinacota" = "Arica y Parinacota",
"Regi\u00f3n de Antofagasta" = "Antofagasta",
"Regi\u00f3n de Coquimbo" = "Coquimbo",
"Regi\u00f3n del Libertador Gral. Bernardo O Higgins" = "O\u0027Higgins",
"Región del Biob\u00edo" = "B\u00edob\u00edo",
"Regi\u00f3n de los Lagos" = "Los Lagos",
"Regi\u00f3n de Magallanes y de la Antártica Chilena" = "Magallanes",
"Regi\u00f3n de los R\u00edos" = "Los R\u00edos"))
levels(nesi_individuals_with_grants_2015$REGION)
source("1_libraries.R")
source("2_load.R")
source("3_batch_load.R")
nesi_individuals_with_grants_2015$REGION <- revalue(nesi_individuals_with_grants_2015$REGION, c("Regi\u00f3n de Tarapac\u00e1" = "Tarapac\u00e1",
"Regi\u00f3n de Atacama" = "Atacama",
"Regi\u00f3n de Valpara\u00edso" = "Valpara\u00edso",
"Regi\u00f3n del Maule" = "Maule",
"Regi\u00f3n de La Araucan\u00eda" = "Araucan\u00eda",
"Regi\u00f3n de Ays\u00e9n del Gral. Carlos Ibáñez del Campo" = "Ays\u00e9n",
"Regi\u00f3n Metropolitana de Santiago" = "Metropolitana",
"Regi\u00f3n de Arica y Parinacota" = "Arica y Parinacota",
"Regi\u00f3n de Antofagasta" = "Antofagasta",
"Regi\u00f3n de Coquimbo" = "Coquimbo",
"Regi\u00f3n del Libertador Gral. Bernardo O Higgins" = "O\u0027Higgins",
"Región del Biob\u00edo" = "B\u00edob\u00edo",
"Regi\u00f3n de Los Lagos" = "Los Lagos",
"Regi\u00f3n de Magallanes y Antártica Chilena" = "Magallanes",
"Regi\u00f3n de Los R\u00edos" = "Los R\u00edos"))
levels(nesi_individuals_with_grants_2015$REGION)
source("1_libraries.R")
source("2_load.R")
source("3_batch_load.R")
source("4_fix_names.R")
levels(nesi_individuals_with_grants_2015$REGION)
source("1_libraries.R")
source("2_load.R")
source("3_batch_load.R")
source("4_fix_names.R")
nesi_individuals_with_grants_2014$REGION <- revalue(nesi_individuals_with_grants_2014$REGION, c("Regi\u00f3n de Tarapac\u00e1" = "Tarapac\u00e1",
"Regi\u00f3n de Atacama" = "Atacama",
"Regi\u00f3n de Valpara\u00edso" = "Valpara\u00edso",
"Regi\u00f3n del Maule" = "Maule",
"Regi\u00f3n de La Araucan\u00eda" = "Araucan\u00eda",
"Regi\u00f3n de Ays\u00e9n del Gral. Carlos Ibáñez del Campo" = "Ays\u00e9n",
"Regi\u00f3n Metropolitana" = "Metropolitana",
"Regi\u00f3n de Arica y Parinacota" = "Arica y Parinacota",
"Regi\u00f3n de Antofagasta" = "Antofagasta",
"Regi\u00f3n de Coquimbo" = "Coquimbo",
"Regi\u00f3n del Libertador Gral. Bernardo O'Higgins" = "O\u0027Higgins",
"Región del Biob\u00edo" = "B\u00edob\u00edo",
"Regi\u00f3n de Los Lagos" = "Los Lagos",
"Regi\u00f3n de Magallanes y Antártica Chilena" = "Magallanes",
"Regi\u00f3n de Los R\u00edos" = "Los R\u00edos"))
nesi_individuals_with_grants_2013$REGION <- revalue(nesi_individuals_with_grants_2013$REGION, c("Regi\u00f3n de Tarapac\u00e1" = "Tarapac\u00e1",
"Regi\u00f3n de Atacama" = "Atacama",
"Regi\u00f3n de Valpara\u00edso" = "Valpara\u00edso",
"Regi\u00f3n del Maule" = "Maule",
"Regi\u00f3n de La Araucan\u00eda" = "Araucan\u00eda",
"Regi\u00f3n de Ays\u00e9n del Gral. Carlos Ibáñez del Campo" = "Ays\u00e9n",
"Regi\u00f3n Metropolitana" = "Metropolitana",
"Regi\u00f3n de Arica y Parinacota" = "Arica y Parinacota",
"Regi\u00f3n de Antofagasta" = "Antofagasta",
"Regi\u00f3n de Coquimbo" = "Coquimbo",
"Regi\u00f3n del Libertador Gral. Bernardo O'Higgins" = "O\u0027Higgins",
"Región del Biob\u00edo" = "B\u00edob\u00edo",
"Regi\u00f3n de Los Lagos" = "Los Lagos",
"Regi\u00f3n de Magallanes y Antártica Chilena" = "Magallanes",
"Regi\u00f3n de Los R\u00edos" = "Los R\u00edos"))
nesi_individuals_with_grants_2012$REGION <- revalue(nesi_individuals_with_grants_2012$REGION, c("Regi\u00f3n de Tarapac\u00e1" = "Tarapac\u00e1",
"Regi\u00f3n de Atacama" = "Atacama",
"Regi\u00f3n de Valpara\u00edso" = "Valpara\u00edso",
"Regi\u00f3n del Maule" = "Maule",
"Regi\u00f3n de La Araucan\u00eda" = "Araucan\u00eda",
"Regi\u00f3n de Ays\u00e9n del Gral. Carlos Ibáñez del Campo" = "Ays\u00e9n",
"Regi\u00f3n Metropolitana" = "Metropolitana",
"Regi\u00f3n de Arica y Parinacota" = "Arica y Parinacota",
"Regi\u00f3n de Antofagasta" = "Antofagasta",
"Regi\u00f3n de Coquimbo" = "Coquimbo",
"Regi\u00f3n del Libertador Gral. Bernardo O'Higgins" = "O\u0027Higgins",
"Región del Biob\u00edo" = "B\u00edob\u00edo",
"Regi\u00f3n de Los Lagos" = "Los Lagos",
"Regi\u00f3n de Magallanes y Antártica Chilena" = "Magallanes",
"Regi\u00f3n de Los R\u00edos" = "Los R\u00edos"))
levels(nesi_individuals_with_grants_2012$REGION)
nesi_individuals_with_grants_2012$REGION <- revalue(nesi_individuals_with_grants_2012$REGION, c("Regi\u00f3n de Tarapac\u00e1" = "Tarapac\u00e1",
"Regi\u00f3n de Atacama" = "Atacama",
"Regi\u00f3n de Valpara\u00edso" = "Valpara\u00edso",
"Regi\u00f3n del Maule" = "Maule",
"Regi\u00f3n de La Araucan\u00eda" = "Araucan\u00eda",
"Regi\u00f3n de Ays\u00e9n del Gral. Carlos Ibañez del Campo" = "Ays\u00e9n",
"Regi\u00f3n Metropolitana" = "Metropolitana",
"Regi\u00f3n de Arica y Parinacota" = "Arica y Parinacota",
"Regi\u00f3n de Antofagasta" = "Antofagasta",
"Regi\u00f3n de Coquimbo" = "Coquimbo",
"Regi\u00f3n del Libertador Gral. Bernardo O'Higgins" = "O\u0027Higgins",
"Región del Biob\u00edo" = "B\u00edob\u00edo",
"Regi\u00f3n de Los Lagos" = "Los Lagos",
"Regi\u00f3n de Magallanes y Antártica Chilena" = "Magallanes",
"Regi\u00f3n de Los R\u00edos" = "Los R\u00edos"))
nesi_individuals_with_grants_2011$REGION <- revalue(nesi_individuals_with_grants_2011$REGION, c("Regi\u00f3n de Tarapac\u00e1" = "Tarapac\u00e1",
"Regi\u00f3n de Atacama" = "Atacama",
"Regi\u00f3n de Valpara\u00edso" = "Valpara\u00edso",
"Regi\u00f3n del Maule" = "Maule",
"Regi\u00f3n de La Araucan\u00eda" = "Araucan\u00eda",
"Regi\u00f3n de Ays\u00e9n del Gral. Carlos Ibáñez del Campo" = "Ays\u00e9n",
"Regi\u00f3n Metropolitana" = "Metropolitana",
"Regi\u00f3n de Arica y Parinacota" = "Arica y Parinacota",
"Regi\u00f3n de Antofagasta" = "Antofagasta",
"Regi\u00f3n de Coquimbo" = "Coquimbo",
"Regi\u00f3n del Libertador Gral. Bernardo O'Higgins" = "O\u0027Higgins",
"Región del Biob\u00edo" = "B\u00edob\u00edo",
"Regi\u00f3n de Los Lagos" = "Los Lagos",
"Regi\u00f3n de Magallanes y Antártica Chilena" = "Magallanes",
"Regi\u00f3n de Los R\u00edos" = "Los R\u00edos"))
levels(nesi_individuals_with_grants_2011$REGION)
nesi_individuals_with_grants_2011$REGION <- revalue(nesi_individuals_with_grants_2011$REGION, c("Regi\u00f3n de Tarapac\u00e1" = "Tarapac\u00e1",
"Regi\u00f3n de Atacama" = "Atacama",
"Regi\u00f3n de Valpara\u00edso" = "Valpara\u00edso",
"Regi\u00f3n del Maule" = "Maule",
"Regi\u00f3n de La Araucan\u00eda" = "Araucan\u00eda",
"Regi\u00f3n De Ais\u00e9n del Gral. Carlos Ibañez del Campo" = "Ays\u00e9n",
"Regi\u00f3n Metropolitana" = "Metropolitana",
"Regi\u00f3n de Arica y Parinacota" = "Arica y Parinacota",
"Regi\u00f3n de Antofagasta" = "Antofagasta",
"Regi\u00f3n de Coquimbo" = "Coquimbo",
"Regi\u00f3n del Libertador Gral. Bernardo O'higgins" = "O\u0027Higgins",
"Región del Bio Bb\u00edo" = "B\u00edob\u00edo",
"Regi\u00f3n de los Lagos" = "Los Lagos",
"Regi\u00f3n de Magallanes y Antártica Chilena" = "Magallanes",
"Regi\u00f3n de Los R\u00edos" = "Los R\u00edos"))
nesi_individuals_with_grants_2010$REGION <- revalue(nesi_individuals_with_grants_2010$REGION, c("Regi\u00f3n de Tarapac\u00e1" = "Tarapac\u00e1",
"Regi\u00f3n de Atacama" = "Atacama",
"Regi\u00f3n de Valpara\u00edso" = "Valpara\u00edso",
"Regi\u00f3n del Maule" = "Maule",
"Regi\u00f3n de La Araucan\u00eda" = "Araucan\u00eda",
"Regi\u00f3n de Ays\u00e9n del Gral. Carlos Ibáñez del Campo" = "Ays\u00e9n",
"Regi\u00f3n Metropolitana" = "Metropolitana",
"Regi\u00f3n de Arica y Parinacota" = "Arica y Parinacota",
"Regi\u00f3n de Antofagasta" = "Antofagasta",
"Regi\u00f3n de Coquimbo" = "Coquimbo",
"Regi\u00f3n del Libertador Gral. Bernardo O'Higgins" = "O\u0027Higgins",
"Región del Biob\u00edo" = "B\u00edob\u00edo",
"Regi\u00f3n de Los Lagos" = "Los Lagos",
"Regi\u00f3n de Magallanes y Antártica Chilena" = "Magallanes",
"Regi\u00f3n de Los R\u00edos" = "Los R\u00edos"))
levels(nesi_individuals_with_grants_2010$REGION)
source("1_libraries.R")
source("2_load.R")
source("3_batch_load.R")
source("4_fix_region.R")
source("1_libraries.R")
source("2_load.R")
source("3_batch_load.R")
nesi_individuals_with_grants_2015$REGION <- revalue(nesi_individuals_with_grants_2015$REGION, c("Regi\u00f3n de Tarapac\u00e1" = "Tarapac\u00e1",
"Regi\u00f3n de Atacama" = "Atacama",
"Regi\u00f3n de Valpara\u00edso" = "Valpara\u00edso",
"Regi\u00f3n del Maule" = "Maule",
"Regi\u00f3n de La Araucan\u00eda" = "Araucan\u00eda",
"Regi\u00f3n de Ays\u00e9n del Gral. Carlos Ibáñez del Campo" = "Ays\u00e9n",
"Regi\u00f3n Metropolitana" = "Metropolitana",
"Regi\u00f3n de Arica y Parinacota" = "Arica y Parinacota",
"Regi\u00f3n de Antofagasta" = "Antofagasta",
"Regi\u00f3n de Coquimbo" = "Coquimbo",
"Regi\u00f3n del Libertador Gral. Bernardo O'Higgins" = "O\u0027Higgins",
"Región del Biob\u00edo" = "B\u00edob\u00edo",
"Regi\u00f3n de Los Lagos" = "Los Lagos",
"Regi\u00f3n de Magallanes y Antártica Chilena" = "Magallanes",
"Regi\u00f3n de Los R\u00edos" = "Los R\u00edos"))
nesi_individuals_with_grants_2014$REGION <- revalue(nesi_individuals_with_grants_2014$REGION, c("Regi\u00f3n de Tarapac\u00e1" = "Tarapac\u00e1",
"Regi\u00f3n de Atacama" = "Atacama",
"Regi\u00f3n de Valpara\u00edso" = "Valpara\u00edso",
"Regi\u00f3n del Maule" = "Maule",
"Regi\u00f3n de La Araucan\u00eda" = "Araucan\u00eda",
"Regi\u00f3n de Ays\u00e9n del Gral. Carlos Ibáñez del Campo" = "Ays\u00e9n",
"Regi\u00f3n Metropolitana" = "Metropolitana",
"Regi\u00f3n de Arica y Parinacota" = "Arica y Parinacota",
"Regi\u00f3n de Antofagasta" = "Antofagasta",
"Regi\u00f3n de Coquimbo" = "Coquimbo",
"Regi\u00f3n del Libertador Gral. Bernardo O'Higgins" = "O\u0027Higgins",
"Región del Biob\u00edo" = "B\u00edob\u00edo",
"Regi\u00f3n de Los Lagos" = "Los Lagos",
"Regi\u00f3n de Magallanes y Antártica Chilena" = "Magallanes",
"Regi\u00f3n de Los R\u00edos" = "Los R\u00edos"))
nesi_individuals_with_grants_2013$REGION <- revalue(nesi_individuals_with_grants_2013$REGION, c("Regi\u00f3n de Tarapac\u00e1" = "Tarapac\u00e1",
"Regi\u00f3n de Atacama" = "Atacama",
"Regi\u00f3n de Valpara\u00edso" = "Valpara\u00edso",
"Regi\u00f3n del Maule" = "Maule",
"Regi\u00f3n de La Araucan\u00eda" = "Araucan\u00eda",
"Regi\u00f3n de Ays\u00e9n del Gral. Carlos Ibáñez del Campo" = "Ays\u00e9n",
"Regi\u00f3n Metropolitana" = "Metropolitana",
"Regi\u00f3n de Arica y Parinacota" = "Arica y Parinacota",
"Regi\u00f3n de Antofagasta" = "Antofagasta",
"Regi\u00f3n de Coquimbo" = "Coquimbo",
"Regi\u00f3n del Libertador Gral. Bernardo O'Higgins" = "O\u0027Higgins",
"Región del Biob\u00edo" = "B\u00edob\u00edo",
"Regi\u00f3n de Los Lagos" = "Los Lagos",
"Regi\u00f3n de Magallanes y Antártica Chilena" = "Magallanes",
"Regi\u00f3n de Los R\u00edos" = "Los R\u00edos"))
nesi_individuals_with_grants_2012$REGION <- revalue(nesi_individuals_with_grants_2012$REGION, c("Regi\u00f3n de Tarapac\u00e1" = "Tarapac\u00e1",
"Regi\u00f3n de Atacama" = "Atacama",
"Regi\u00f3n de Valpara\u00edso" = "Valpara\u00edso",
"Regi\u00f3n del Maule" = "Maule",
"Regi\u00f3n de La Araucan\u00eda" = "Araucan\u00eda",
"Regi\u00f3n de Ays\u00e9n del Gral. Carlos Ibañez del Campo" = "Ays\u00e9n",
"Regi\u00f3n Metropolitana" = "Metropolitana",
"Regi\u00f3n de Arica y Parinacota" = "Arica y Parinacota",
"Regi\u00f3n de Antofagasta" = "Antofagasta",
"Regi\u00f3n de Coquimbo" = "Coquimbo",
"Regi\u00f3n del Libertador Gral. Bernardo O'Higgins" = "O\u0027Higgins",
"Región del Biob\u00edo" = "B\u00edob\u00edo",
"Regi\u00f3n de Los Lagos" = "Los Lagos",
"Regi\u00f3n de Magallanes y Antártica Chilena" = "Magallanes",
"Regi\u00f3n de Los R\u00edos" = "Los R\u00edos"))
nesi_individuals_with_grants_2011$REGION <- revalue(nesi_individuals_with_grants_2011$REGION, c("Regi\u00f3n de Tarapac\u00e1" = "Tarapac\u00e1",
"Regi\u00f3n de Atacama" = "Atacama",
"Regi\u00f3n de Valpara\u00edso" = "Valpara\u00edso",
"Regi\u00f3n del Maule" = "Maule",
"Regi\u00f3n de La Araucan\u00eda" = "Araucan\u00eda",
"Regi\u00f3n De Ais\u00e9n del Gral. Carlos Ibañez del Campo" = "Ays\u00e9n",
"Regi\u00f3n Metropolitana" = "Metropolitana",
"Regi\u00f3n de Arica y Parinacota" = "Arica y Parinacota",
"Regi\u00f3n de Antofagasta" = "Antofagasta",
"Regi\u00f3n de Coquimbo" = "Coquimbo",
"Regi\u00f3n del Libertador Gral. Bernardo O'higgins" = "O\u0027Higgins",
"Región del Bio Bb\u00edo" = "B\u00edob\u00edo",
"Regi\u00f3n de los Lagos" = "Los Lagos",
"Regi\u00f3n de Magallanes y Antártica Chilena" = "Magallanes",
"Regi\u00f3n de Los R\u00edos" = "Los R\u00edos"))
levels(nesi_individuals_with_grants_2011$REGION)
nesi_individuals_with_grants_2010$REGION <- revalue(nesi_individuals_with_grants_2010$REGION, c("Regi\u00f3n de Tarapac\u00e1" = "Tarapac\u00e1",
"Regi\u00f3n de Atacama" = "Atacama",
"Regi\u00f3n de Valpara\u00edso" = "Valpara\u00edso",
"Regi\u00f3n del Maule" = "Maule",
"Regi\u00f3n de La Araucan\u00eda" = "Araucan\u00eda",
"Regi\u00f3n de Ais\u00e9n del Gral. Carlos Ibañez del Campo" = "Ays\u00e9n",
"Regi\u00f3n Metropolitana" = "Metropolitana",
"Regi\u00f3n de Arica y Parinacota" = "Arica y Parinacota",
"Regi\u00f3n de Antofagasta" = "Antofagasta",
"Regi\u00f3n de Coquimbo" = "Coquimbo",
"Regi\u00f3n del Libertador Gral Bernardo O'higgins" = "O\u0027Higgins",
"Región del Biob\u00edo" = "B\u00edob\u00edo",
"Regi\u00f3n de Los Lagos" = "Los Lagos",
"Regi\u00f3n de Magallanes y Antártica Chilena" = "Magallanes",
"Regi\u00f3n de Los R\u00edos" = "Los R\u00edos"))
levels(nesi_individuals_with_grants_2010$REGION)
nesi_individuals_with_grants_2010$REGION <- revalue(nesi_individuals_with_grants_2010$REGION, c("Regi\u00f3n de Tarapac\u00e1" = "Tarapac\u00e1",
"Regi\u00f3n de Atacama" = "Atacama",
"Regi\u00f3n de Valparaiso" = "Valpara\u00edso",
"Regi\u00f3n del Maule" = "Maule",
"Regi\u00f3n de La Araucan\u00eda" = "Araucan\u00eda",
"Regi\u00f3n de Ais\u00e9n del Gral. Carlos Ibañez del Campo" = "Ays\u00e9n",
"Regi\u00f3n Metropolitana" = "Metropolitana",
"Regi\u00f3n de Arica y Parinacota" = "Arica y Parinacota",
"Regi\u00f3n de Antofagasta" = "Antofagasta",
"Regi\u00f3n de Coquimbo" = "Coquimbo",
"Regi\u00f3n del Libertador Gral Bernardo O'higgins" = "O\u0027Higgins",
"Región del Bio B\u00edo" = "B\u00edob\u00edo",
"Regi\u00f3n de Los Lagos" = "Los Lagos",
"Regi\u00f3n de Magallanes y Antártica Chilena" = "Magallanes",
"Regi\u00f3n de los R\u00edos" = "Los R\u00edos"))
source("1_libraries.R")
source("2_load.R")
source("3_batch_load.R")
nesi_individuals_with_grants_2010$REGION <- revalue(nesi_individuals_with_grants_2010$REGION, c("Regi\u00f3n de Tarapac\u00e1" = "Tarapac\u00e1",
"Regi\u00f3n de Atacama" = "Atacama",
"Regi\u00f3n de Valparaiso" = "Valpara\u00edso",
"Regi\u00f3n del Maule" = "Maule",
"Regi\u00f3n de La Araucan\u00eda" = "Araucan\u00eda",
"Regi\u00f3n de Ais\u00e9n del Gral. Carlos Ibañez del Campo" = "Ays\u00e9n",
"Regi\u00f3n Metropolitana" = "Metropolitana",
"Regi\u00f3n de Arica y Parinacota" = "Arica y Parinacota",
"Regi\u00f3n de Antofagasta" = "Antofagasta",
"Regi\u00f3n de Coquimbo" = "Coquimbo",
"Regi\u00f3n del Libertador Gral Bernardo O'higgins" = "O\u0027Higgins",
"Región del Bio B\u00edo" = "B\u00edob\u00edo",
"Regi\u00f3n de Los Lagos" = "Los Lagos",
"Regi\u00f3n de Magallanes y Antártica Chilena" = "Magallanes",
"Regi\u00f3n de los R\u00edos" = "Los R\u00edos"))
levels(nesi_individuals_with_grants_2010$REGION)
source("1_libraries.R")
source("2_load.R")
source("3_batch_load.R")
nesi_individuals_with_grants_2010$REGION <- revalue(nesi_individuals_with_grants_2010$REGION, c("Regi\u00f3n de Tarapac\u00e1" = "Tarapac\u00e1",
"Regi\u00f3n de Atacama" = "Atacama",
"Regi\u00f3n de Valparaiso" = "Valpara\u00edso",
"Regi\u00f3n del Maule" = "Maule",
"Regi\u00f3n de La Araucan\u00eda" = "Araucan\u00eda",
"Regi\u00f3n de Ais\u00e9n del Gral. Carlos Ibañez del Campo" = "Ays\u00e9n",
"Regi\u00f3n Metropolitana" = "Metropolitana",
"Regi\u00f3n de Arica y Parinacota" = "Arica y Parinacota",
"Regi\u00f3n de Antofagasta" = "Antofagasta",
"Regi\u00f3n de Coquimbo" = "Coquimbo",
"Regi\u00f3n del Libertador Gral Bernardo O'higgins" = "O\u0027Higgins",
"Región del Bio B\u00edo" = "B\u00edob\u00edo",
"Regi\u00f3n de los Lagos" = "Los Lagos",
"Regi\u00f3n de Magallanes y Antártica Chilena" = "Magallanes",
"Regi\u00f3n de los R\u00edos" = "Los R\u00edos"))
levels(nesi_individuals_with_grants_2010$REGION)
source("1_libraries.R")
source("2_load.R")
source("3_batch_load.R")
nesi_individuals_with_grants_2010$REGION <- revalue(nesi_individuals_with_grants_2010$REGION, c("Regi\u00f3n de Tarapac\u00e1" = "Tarapac\u00e1",
"Regi\u00f3n de Atacama" = "Atacama",
"Regi\u00f3n de Valparaiso" = "Valpara\u00edso",
"Regi\u00f3n del Maule" = "Maule",
"Regi\u00f3n de La Araucan\u00eda" = "Araucan\u00eda",
"Regi\u00f3n De Ais\u00e9n del Gral. Carlos Iba\u00f1ez del Campo" = "Ays\u00e9n",
"Regi\u00f3n Metropolitana" = "Metropolitana",
"Regi\u00f3n de Arica y Parinacota" = "Arica y Parinacota",
"Regi\u00f3n de Antofagasta" = "Antofagasta",
"Regi\u00f3n de Coquimbo" = "Coquimbo",
"Regi\u00f3n del Libertador Gral Bernardo O'higgins" = "O\u0027Higgins",
"Región del Bio B\u00edo" = "B\u00edob\u00edo",
"Regi\u00f3n de los Lagos" = "Los Lagos",
"Regi\u00f3n de Magallanes y Antártica Chilena" = "Magallanes",
"Regi\u00f3n de los R\u00edos" = "Los R\u00edos"))
levels(nesi_individuals_with_grants_2010$REGION)
nesi_individuals_with_grants_2011$REGION <- revalue(nesi_individuals_with_grants_2011$REGION, c("Regi\u00f3n de Tarapac\u00e1" = "Tarapac\u00e1",
"Regi\u00f3n de Atacama" = "Atacama",
"Regi\u00f3n de Valpara\u00edso" = "Valpara\u00edso",
"Regi\u00f3n del Maule" = "Maule",
"Regi\u00f3n de La Araucan\u00eda" = "Araucan\u00eda",
"Regi\u00f3n De Ais\u00e9n del Gral. Carlos Iba\u00f1ez del Campo" = "Ays\u00e9n",
"Regi\u00f3n Metropolitana" = "Metropolitana",
"Regi\u00f3n de Arica y Parinacota" = "Arica y Parinacota",
"Regi\u00f3n de Antofagasta" = "Antofagasta",
"Regi\u00f3n de Coquimbo" = "Coquimbo",
"Regi\u00f3n del Libertador Gral Bernardo O'higgins" = "O\u0027Higgins",
"Región del Bio B\u00edo" = "B\u00edob\u00edo",
"Regi\u00f3n de los Lagos" = "Los Lagos",
"Regi\u00f3n de Magallanes y Antártica Chilena" = "Magallanes",
"Regi\u00f3n de los R\u00edos" = "Los R\u00edos"))
levels(nesi_individuals_with_grants_2011$REGION)
nesi_individuals_with_grants_2012$REGION <- revalue(nesi_individuals_with_grants_2012$REGION, c("Regi\u00f3n de Tarapac\u00e1" = "Tarapac\u00e1",
"Regi\u00f3n de Atacama" = "Atacama",
"Regi\u00f3n de Valpara\u00edso" = "Valpara\u00edso",
"Regi\u00f3n del Maule" = "Maule",
"Regi\u00f3n de La Araucan\u00eda" = "Araucan\u00eda",
"Regi\u00f3n de Ays\u00e9n del Gral. Carlos Iba\u00f1ez del Campo" = "Ays\u00e9n",
"Regi\u00f3n Metropolitana" = "Metropolitana",
"Regi\u00f3n de Arica y Parinacota" = "Arica y Parinacota",
"Regi\u00f3n de Antofagasta" = "Antofagasta",
"Regi\u00f3n de Coquimbo" = "Coquimbo",
"Regi\u00f3n del Libertador Gral. Bernardo O'Higgins" = "O\u0027Higgins",
"Región del Biob\u00edo" = "B\u00edob\u00edo",
"Regi\u00f3n de Los Lagos" = "Los Lagos",
"Regi\u00f3n de Magallanes y Antártica Chilena" = "Magallanes",
"Regi\u00f3n de Los R\u00edos" = "Los R\u00edos"))
source("1_libraries.R")
source("2_load.R")
source("3_batch_load.R")
source("4_fix_region.R")
source("1_libraries.R")
source("2_load.R")
source("3_batch_load.R")
source("4_fix_region.R")
nesi_individuals_with_grants_2010$NACIONALIDAD
source("1_libraries.R")
source("2_load.R")
source("3_batch_load.R")
source("4_fix_region.R")
nesi_individuals_with_grants_2014$ING_T_P
names(nesi_individuals_with_grants_2014)
nesi_2014 <- nesi_individuals_with_grants_2014[,c("ING_T_P", "FACT_PER", "OCUP_REF", "SEXO", "REGION", "CISE")]
nesi_2014$YEAR <- 2014
nesi_2015 <- nesi_individuals_with_grants_2015[,c("ING_T_P", "FACT_PER", "OCUP_REF", "SEXO", "REGION", "CISE")]
nesi_2015$YEAR <- 2015
nesi_2013 <- nesi_individuals_with_grants_2013[,c("ING_T_P", "FACT_PER", "OCUP_REF", "SEXO", "REGION", "CISE")]
nesi_2013$YEAR <- 2013
nesi_2012 <- nesi_individuals_with_grants_2012[,c("ING_T_P", "FACT_PER", "OCUP_REF", "SEXO", "REGION", "CISE")]
nesi_2012$YEAR <- 2012
nesi_2011 <- nesi_individuals_with_grants_2011[,c("ING_T_P", "FACT_PER", "OCUP_REF", "SEXO", "REGION", "CISE")]
nesi_2011$YEAR <- 2011
nesi_2010 <- nesi_individuals_with_grants_2010[,c("ING_T_P", "FACT_PER", "OCUP_REF", "SEXO", "REGION", "CISE")]
nesi_2010$YEAR <- 2010
nesi_tidy <- cbind(nesi_2010,nesi_2011,nesi_2012,nesi_2013,nesi_2014,nesi_2015)
nesi_tidy <- rbind(nesi_2010,nesi_2011,nesi_2012,nesi_2013,nesi_2014,nesi_2015)
rm(nesi_2010,nesi_2011,nesi_2012,nesi_2013,nesi_2014,nesi_2015)
nesi_tidy$FACT_PER
aggregate(ING_T_P ~ OCUP_REF, data = subset(nesi_tidy, nesi_tidy$YEAR == 2014))
aggregate(ING_T_P ~ OCUP_REF, data = subset(nesi_tidy, nesi_tidy$YEAR == 2014), FUN = sum)
wtd.quantile(nesi_tidy$ING_T_P, weights=nesi_tidy$FACT_PER, probs=c(0, .25, .5, .75, 1),
type=c('quantile','(i-1)/(n-1)','i/(n+1)','i/n'),
normwt=FALSE, na.rm=TRUE)
library(Hmisc)
wtd.quantile(nesi_tidy$ING_T_P, weights=nesi_tidy$FACT_PER, probs=c(0, .25, .5, .75, 1),
type=c('quantile','(i-1)/(n-1)','i/(n+1)','i/n'),
normwt=FALSE, na.rm=TRUE)
wtd.quantile(nesi_individuals_with_grants_2015$ING_T_P, weights=nesi_individuals_with_grants_2015$FACT_PER, probs=c(0, .25, .5, .75, 1),
type=c('quantile','(i-1)/(n-1)','i/(n+1)','i/n'),
normwt=FALSE, na.rm=TRUE)
wtd.quantile(nesi_individuals_with_grants_2014$ING_T_P, weights=nesi_individuals_with_grants_2014$FACT_PER, probs=c(0, .25, .5, .75, 1),
type=c('quantile','(i-1)/(n-1)','i/(n+1)','i/n'),
normwt=FALSE, na.rm=TRUE)
library(survey)
install.packages("survey")
nesi_2015 <- nesi_individuals_with_grants_2015[,c("ING_T_P", "FACT_PER", "OCUP_REF", "SEXO", "REGION", "CISE")]
nesi_2015$YEAR <- 2015
nesi_2015 <- svydesign(id = ~1, data = nesi_2015, weight = ~FACT_PER)
library(survey)
nesi_2015 <- svydesign(id = ~1, data = nesi_2015, weight = ~FACT_PER)
